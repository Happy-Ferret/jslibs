@@ -49,8 +49,34 @@
 #include <stdlib.h>
 #include <string.h>
 
+#define JS_HAS_JSLIBS_RegisterCustomAllocators
+
 JS_BEGIN_EXTERN_C
 
+extern JS_PUBLIC_API(void)
+JSLIBS_RegisterCustomAllocators(
+  void* (*)( size_t ),
+  void* (*)( size_t, size_t ),
+  void* (*)( size_t, size_t ),
+  void* (*)( void*, size_t ),
+  size_t (*)( void* ),
+  void (*)( void* )
+);
+
+extern void* (*custom_malloc)( size_t );
+extern void* (*custom_calloc)( size_t, size_t );
+extern void* (*custom_realloc)( void*, size_t );
+extern void (*custom_free)( void* );
+
+JS_END_EXTERN_C
+
+#define malloc custom_malloc
+#define calloc custom_calloc
+#define realloc custom_realloc
+#define free custom_free
+
+JS_BEGIN_EXTERN_C
+
 #define JS_CRASH_UNLESS(__cond)                                                 \
     JS_BEGIN_MACRO                                                              \
         if (!(__cond)) {                                                        \
@@ -674,4 +700,9 @@
 
 #endif /* defined(__cplusplus) */
 
+#undef malloc
+#undef calloc
+#undef realloc
+#undef free
+
 #endif /* jsutil_h___ */
